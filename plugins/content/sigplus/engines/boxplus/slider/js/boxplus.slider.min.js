/*
 boxplus image slider engine
 @author  Levente Hunyadi
 @version 1.3.4
 @remarks Copyright (C) 2009-2010 Levente Hunyadi
 @remarks Licensed under GNU/GPLv3, see http://www.gnu.org/licenses/gpl-3.0.html
 @see     http://hunyadi.info.hu/projects/boxplus
*/
if(typeof __jQuery__=="undefined")var __jQuery__=jQuery;
(function(b){var p="boxplus-disabled",C="boxplus-hidden",D="boxplus-loading";b.fn.maxOuterWidth=function(){var a=0;this.each(function(p,j){a=Math.max(a,b(j).outerWidth(!0))});return a};b.fn.maxOuterHeight=function(){var a=0;this.each(function(p,j){a=Math.max(a,b(j).outerHeight(!0))});return a};b.fn.boxplusSlider=function(a){a=b.extend({rtl:!1,rowCount:1,columnCount:2,orientation:"horizontal",navigation:"top",step:"page",showButtons:!0,showLinks:!0,showPageCounter:!0,showOverlayButtons:!0,contextmenu:!0,
duration:800,delay:0,opacity:1},a);this.filter("ul, ol").each(function(){function E(b,a,c){for(q=0;q<b;q++)for(r=0;r<a;r++)f.eq(c?q*a+r:r*b+q).css({top:q*m}).css(s?"right":"left",r*k)}function j(b){return'<a class="boxplus-'+b+'" href="javascript:void(0)" />'}function t(b){return'<div class="boxplus-'+b+'" />'}function F(a){return a.filter(function(){return/\.(gif|jpe?g|png)$/i.test(b("img:first",this).attr("longdesc"))})}function G(a){F(a).each(function(){var a=b("img:first",this);a.attr("data-thumb",
a.attr("src")).attr("src",a.attr("longdesc")).removeAttr("longdesc")});a.removeClass(D).children().removeClass(C);H()}function H(){f.slice(c,c+h).mouseenter().mouseleave()}function I(){u("cycle")}function u(a){switch(a){case "first":c=0;break;case "prev":c=c>=n?c-n:0;break;case "next":c=c<v?c+n:v;break;case "last":c=v;break;case "cycle":c=c>=v?0:c+n;break;default:c=Math.floor(a/n)*n}var d=Math.max(0,c-h),e=Math.min(i,c+2*h);f.slice(0,d).detach();f.slice(e).detach();var g={};y?g.top=-(c/o*m):g[s?"right":
"left"]=-(c/w*k);switch(a){case "first":case "last":l.css(b.extend(g,{opacity:0}));A();l.prepend(f.slice(0,d)).append(f.slice(e));l.animate({opacity:1},B,"linear");break;default:A(),l.animate(g,B,"swing",function(){l.prepend(f.slice(0,d)).append(f.slice(e))})}}function A(){L.add(M).toggleClass(p,c<=0);N.add(O).toggleClass(p,c>=v);b(".boxplus-current",d).text(c/h+1);f.slice(Math.max(0,c-h),Math.min(i,c+2*h)).trigger("boxplus-load");H()}var w=a.rowCount,o=a.columnCount,h=w*o,B=a.duration,z=a.delay,
c=0,f=b("li:visible",this),x=f.find("img:first"),k=x.maxOuterWidth(),m=x.maxOuterHeight(),l=b(this).wrap("<div />"),d=l.parent().addClass("boxplus-slider").addClass(p);d.wrapInner('<div class="boxplus-viewport" />');f.css({width:k,height:m});k=f.maxOuterWidth();m=f.maxOuterHeight();var s=a.rtl,i=f.length,e,g,q,r,y=a.orientation=="vertical";y?(g=o,e=Math.ceil(i/o),E(e,g,!0)):(g=Math.ceil(i/w),e=w,E(e,g));switch(a.step){case "single":var n=y?o:w,v=i-h;break;default:n=h,v=i%h?i-i%h:i-h}l.css({width:g*
k,height:e*m,left:s?"auto":0,right:s?0:"auto"});b(".boxplus-viewport",d).css({width:o*k,height:w*m});d.css("width",o*k);e=a.showButtons;g=a.showLinks;var J=a.showPageCounter;if(e||g||J)switch(e='<div class="boxplus-paging">'+(e?t("first")+t("prev"):"")+(g?j("first")+"&nbsp;"+j("prev")+" ":"")+(J?'<span class="boxplus-current">1</span> / '+('<span class="boxplus-total">'+Math.ceil(i/h)+"</span>"):"")+(g?" "+j("next")+"&nbsp;"+j("last"):"")+(e?t("next")+t("last"):"")+"</div>",a.navigation){case "both":d.prepend(e).append(e);
break;case "top":d.prepend(e);break;default:d.append(e)}a.showOverlayButtons&&b(".boxplus-viewport",d).append(b(t("prev")+t("next")).addClass((y?k:m)<120?"boxplus-small":"boxplus-large").addClass(y?"boxplus-vertical":"boxplus-horizontal"));a.contextmenu||b(document).bind("contextmenu",function(a){return!x.filter(a.target).size()});var M=b(".boxplus-first",d).click(function(){u("first")}),L=b(".boxplus-prev",d).click(function(){u("prev")}),N=b(".boxplus-next",d).click(function(){u("next")}),O=b(".boxplus-last",
d).click(function(){u("last")});f.addClass(D).children().addClass(C);G(f.not(F(f).one("boxplus-load",function(a){var c=b(a.target);a=b("img:first",c);b(new Image).load(function(){G(c)}).attr("src",a.attr("longdesc"))}).get()));A();d.removeClass(p);l.css({top:0,left:s?"auto":0,right:s?0:"auto",visibility:"visible"});x.each(function(a){var c=b(this).parent("a");c.size()&&c[0].href==window.location.href&&u(a)});a.opacity<1&&(x.css("opacity",a.opacity),x.hover(function(){b(this).stop().animate({opacity:1},
"slow")},function(){b(this).stop().animate({opacity:a.opacity},"slow")}));if(z>0){z=Math.max(z,B);var K=window.setInterval(I,z);d.mouseover(function(){window.clearInterval(K)}).mouseout(function(){K=window.setInterval(I,z)})}});return this}})(__jQuery__);
